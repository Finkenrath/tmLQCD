static void fatten_links_with_force_terms(su3 *out, stout_notes_t *notes, double rho, su3 const *staples, su3 const *in)
{
  _su3_times_su3d(notes->Q, *staples, *in);
  project_antiherm(&notes->Q);
  _real_times_su3(notes->Q, rho, notes->Q);
  cayley_hamilton_exponent_with_force_terms(&notes->expiQ, &notes->B1, &notes->B2, &notes->f1, &notes->f2, &notes->Q);
  _su3_times_su3(*out, notes->expiQ, *in);
}

#include "stout_construct_Z.static"

static void construct_Z_1(stout_notes_three_index * const trace, gauge_field_t const U)
{
#pragma omp for
  for (unsigned int x = 0; x < VOLUME; ++x)
    for (unsigned int comp = 0; comp < hyp_perm_full; ++comp)
      inner_Z_loop(&trace[x][comp], &U[x][hyp_comp_full[comp].mu]);
  
#pragma omp single
  generic_exchange((stout_notes_three_index**)(&trace), sizeof(stout_notes_three_index));
}

static void construct_Z_2(stout_notes_two_index * const trace, gauge_field_t const U)
{
#pragma omp for
  for (unsigned int x = 0; x < VOLUME; ++x)
    for (unsigned int comp = 0; comp < hyp_perm_symm; ++comp)
      inner_Z_loop(&trace[x][comp], &U[x][hyp_comp_symm[comp].mu]);
    
#pragma omp single
  generic_exchange((stout_notes_two_index **)(&trace), sizeof(stout_notes_two_index));
}

